-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------->
 Trino version: 477                                                                                                                                                                                                                                                                                                                                                                                                                                                                         >
 Fragment 0 [SINGLE]                                                                                                                                                                                                                                                                                                                                                                                                                                                                        >
     Output layout: [ss_customer_sk, sum]                                                                                                                                                                                                                                                                                                                                                                                                                                                   >
     Output partitioning: SINGLE []                                                                                                                                                                                                                                                                                                                                                                                                                                                         >
     Output[columnNames = [ss_customer_sk, sumsales]]                                                                                                                                                                                                                                                                                                                                                                                                                                       >
     │   Layout: [ss_customer_sk:bigint, sum:decimal(38,2)]                                                                                                                                                                                                                                                                                                                                                                                                                                 >
     │   Estimates: {rows: 100 (2.54kB), cpu: 0, memory: 0B, network: 0B}                                                                                                                                                                                                                                                                                                                                                                                                                   >
     │   sumsales := sum                                                                                                                                                                                                                                                                                                                                                                                                                                                                    >
     └─ TopN[count = 100, orderBy = [sum ASC NULLS LAST, ss_customer_sk ASC NULLS LAST]]                                                                                                                                                                                                                                                                                                                                                                                                    >
        │   Layout: [ss_customer_sk:bigint, sum:decimal(38,2)]                                                                                                                                                                                                                                                                                                                                                                                                                              >
        │   Estimates: {rows: 100 (2.54kB), cpu: ?, memory: ?, network: ?}                                                                                                                                                                                                                                                                                                                                                                                                                  >
        └─ LocalExchange[partitioning = SINGLE]                                                                                                                                                                                                                                                                                                                                                                                                                                             >
           │   Layout: [ss_customer_sk:bigint, sum:decimal(38,2)]                                                                                                                                                                                                                                                                                                                                                                                                                           >
           │   Estimates: {rows: ? (?), cpu: 0, memory: 0B, network: 0B}                                                                                                                                                                                                                                                                                                                                                                                                                    >
           └─ RemoteSource[sourceFragmentIds = [1]]                                                                                                                                                                                                                                                                                                                                                                                                                                         >
                  Layout: [ss_customer_sk:bigint, sum:decimal(38,2)]                                                                                                                                                                                                                                                                                                                                                                                                                        >
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            >
 Fragment 1 [HASH]                                                                                                                                                                                                                                                                                                                                                                                                                                                                          >
     Output layout: [ss_customer_sk, sum]                                                                                                                                                                                                                                                                                                                                                                                                                                                   >
     Output partitioning: SINGLE []                                                                                                                                                                                                                                                                                                                                                                                                                                                         >
     TopNPartial[count = 100, orderBy = [sum ASC NULLS LAST, ss_customer_sk ASC NULLS LAST]]                                                                                                                                                                                                                                                                                                                                                                                                >
     │   Layout: [ss_customer_sk:bigint, sum:decimal(38,2)]                                                                                                                                                                                                                                                                                                                                                                                                                                 >
     └─ LocalExchange[partitioning = SINGLE]                                                                                                                                                                                                                                                                                                                                                                                                                                                >
        │   Layout: [ss_customer_sk:bigint, sum:decimal(38,2)]                                                                                                                                                                                                                                                                                                                                                                                                                              >
        │   Estimates: {rows: ? (?), cpu: 0, memory: 0B, network: 0B}                                                                                                                                                                                                                                                                                                                                                                                                                       >
        └─ TopNPartial[count = 100, orderBy = [sum ASC NULLS LAST, ss_customer_sk ASC NULLS LAST]]                                                                                                                                                                                                                                                                                                                                                                                          >
           │   Layout: [ss_customer_sk:bigint, sum:decimal(38,2)]                                                                                                                                                                                                                                                                                                                                                                                                                           >
           └─ LocalExchange[partitioning = ROUND_ROBIN]                                                                                                                                                                                                                                                                                                                                                                                                                                     >
              │   Layout: [ss_customer_sk:bigint, sum:decimal(38,2)]                                                                                                                                                                                                                                                                                                                                                                                                                        >
              │   Estimates: {rows: ? (?), cpu: ?, memory: 0B, network: 0B}                                                                                                                                                                                                                                                                                                                                                                                                                 >
              └─ TopNPartial[count = 100, orderBy = [sum ASC NULLS LAST, ss_customer_sk ASC NULLS LAST]]                                                                                                                                                                                                                                                                                                                                                                                    >
                 │   Layout: [ss_customer_sk:bigint, sum:decimal(38,2)]                                                                                                                                                                                                                                                                                                                                                                                                                     >
                 └─ Aggregate[type = FINAL, keys = [ss_customer_sk]]                                                                                                                                                                                                                                                                                                                                                                                                                        >
                    │   Layout: [ss_customer_sk:bigint, sum:decimal(38,2)]                                                                                                                                                                                                                                                                                                                                                                                                                  >
                    │   Estimates: {rows: ? (?), cpu: ?, memory: ?, network: 0B}                                                                                                                                                                                                                                                                                                                                                                                                            >
                    │   sum := sum(sum_0)                                                                                                                                                                                                                                                                                                                                                                                                                                                   >
                    └─ LocalExchange[partitioning = HASH, arguments = [ss_customer_sk::bigint]]                                                                                                                                                                                                                                                                                                                                                                                             >
                       │   Layout: [ss_customer_sk:bigint, sum_0:varbinary]                                                                                                                                                                                                                                                                                                                                                                                                                 >
                       │   Estimates: {rows: ? (?), cpu: ?, memory: 0B, network: 0B}                                                                                                                                                                                                                                                                                                                                                                                                        >
                       └─ RemoteSource[sourceFragmentIds = [2]]                                                                                                                                                                                                                                                                                                                                                                                                                             >
                              Layout: [ss_customer_sk:bigint, sum_0:varbinary]                                                                                                                                                                                                                                                                                                                                                                                                              >
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            >
 Fragment 2 [HASH]                                                                                                                                                                                                                                                                                                                                                                                                                                                                          >
     Output layout: [ss_customer_sk, sum_0]                                                                                                                                                                                                                                                                                                                                                                                                                                                 >
     Output partitioning: HASH [ss_customer_sk]                                                                                                                                                                                                                                                                                                                                                                                                                                             >
     Aggregate[type = PARTIAL, keys = [ss_customer_sk]]                                                                                                                                                                                                                                                                                                                                                                                                                                     >
     │   Layout: [ss_customer_sk:bigint, sum_0:varbinary]                                                                                                                                                                                                                                                                                                                                                                                                                                   >
     │   sum_0 := sum(expr)                                                                                                                                                                                                                                                                                                                                                                                                                                                                 >
     └─ Project[]                                                                                                                                                                                                                                                                                                                                                                                                                                                                           >
        │   Layout: [expr:decimal(18,2), ss_customer_sk:bigint]                                                                                                                                                                                                                                                                                                                                                                                                                             >
        │   Estimates: {rows: ? (?), cpu: ?, memory: 0B, network: 0B}                                                                                                                                                                                                                                                                                                                                                                                                                       >
        │   expr := (CASE WHEN $not((sr_return_quantity IS NULL)) THEN $operator$multiply(CAST($operator$subtract(ss_quantity, sr_return_quantity) AS decimal(10,0)), ss_sales_price) ELSE $operator$multiply(CAST(ss_quantity AS decimal(10,0)), ss_sales_price) END)                                                                                                                                                                                                                      >
        └─ InnerJoin[criteria = (sr_reason_sk = r_reason_sk), distribution = PARTITIONED]                                                                                                                                                                                                                                                                                                                                                                                                   >
           │   Layout: [ss_quantity:integer, ss_sales_price:decimal(7,2), ss_customer_sk:bigint, sr_return_quantity:integer]                                                                                                                                                                                                                                                                                                                                                                >
           │   Estimates: {rows: ? (?), cpu: ?, memory: ?, network: 0B}                                                                                                                                                                                                                                                                                                                                                                                                                     >
           │   Distribution: PARTITIONED                                                                                                                                                                                                                                                                                                                                                                                                                                                    >
           │   dynamicFilterAssignments = {r_reason_sk -> #df_620}                                                                                                                                                                                                                                                                                                                                                                                                                          >
           ├─ RemoteSource[sourceFragmentIds = [3]]                                                                                                                                                                                                                                                                                                                                                                                                                                         >
           │      Layout: [ss_quantity:integer, ss_sales_price:decimal(7,2), ss_customer_sk:bigint, sr_return_quantity:integer, sr_reason_sk:bigint]                                                                                                                                                                                                                                                                                                                                        >
           └─ LocalExchange[partitioning = HASH, arguments = [r_reason_sk::bigint]]                                                                                                                                                                                                                                                                                                                                                                                                         >
              │   Layout: [r_reason_sk:bigint]                                                                                                                                                                                                                                                                                                                                                                                                                                              >
              │   Estimates: {rows: ? (?), cpu: ?, memory: 0B, network: 0B}                                                                                                                                                                                                                                                                                                                                                                                                                 >
              └─ RemoteSource[sourceFragmentIds = [4]]                                                                                                                                                                                                                                                                                                                                                                                                                                      >
                     Layout: [r_reason_sk:bigint]                                                                                                                                                                                                                                                                                                                                                                                                                                           >
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            >
 Fragment 3 [SOURCE]                                                                                                                                                                                                                                                                                                                                                                                                                                                                        >
     Output layout: [ss_quantity, ss_sales_price, ss_customer_sk, sr_return_quantity, sr_reason_sk]                                                                                                                                                                                                                                                                                                                                                                                         >
     Output partitioning: HASH [sr_reason_sk]                                                                                                                                                                                                                                                                                                                                                                                                                                               >
     ScanFilter[table = psql:Query[SELECT "ss_item_sk_0", "ss_customer_sk_1", "ss_ticket_number_2", "ss_quantity_3", "ss_sales_price_4", "sr_item_sk_5", "sr_reason_sk_6", "sr_ticket_number_7", "sr_return_quantity_8" FROM (SELECT "ss_item_sk" AS "ss_item_sk_0", "ss_customer_sk" AS "ss_customer_sk_1", "ss_ticket_number" AS "ss_ticket_number_2", "ss_quantity" AS "ss_quantity_3", "ss_sales_price" AS "ss_sales_price_4" FROM (SELECT "ss_item_sk", "ss_customer_sk", "ss_ticket_nu>
         Layout: [ss_quantity:integer, ss_sales_price:decimal(7,2), ss_customer_sk:bigint, sr_return_quantity:integer, sr_reason_sk:bigint]                                                                                                                                                                                                                                                                                                                                                 >
         Estimates: {rows: 197532954 (5.70GB), cpu: 5.70G, memory: 0B, network: 0B}/{rows: 197532954 (5.70GB), cpu: 5.70G, memory: 0B, network: 0B}                                                                                                                                                                                                                                                                                                                                         >
         ss_quantity := ss_quantity_3:integer:int4                                                                                                                                                                                                                                                                                                                                                                                                                                          >
         sr_return_quantity := sr_return_quantity_8:integer:int4                                                                                                                                                                                                                                                                                                                                                                                                                            >
         ss_sales_price := ss_sales_price_4:decimal(7,2):numeric                                                                                                                                                                                                                                                                                                                                                                                                                            >
         sr_reason_sk := sr_reason_sk_6:bigint:int8                                                                                                                                                                                                                                                                                                                                                                                                                                         >
         ss_customer_sk := ss_customer_sk_1:bigint:int8                                                                                                                                                                                                                                                                                                                                                                                                                                     >
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            >
 Fragment 4 [SOURCE]                                                                                                                                                                                                                                                                                                                                                                                                                                                                        >
     Output layout: [r_reason_sk]                                                                                                                                                                                                                                                                                                                                                                                                                                                           >
     Output partitioning: HASH [r_reason_sk]                                                                                                                                                                                                                                                                                                                                                                                                                                                >
     TableScan[table = psql:tpcds.reason tpcds.tpcds.reason columns=[r_reason_sk:bigint:int8]]                                                                                                                                                                                                                                                                                                                                                                                              >
         Layout: [r_reason_sk:bigint]                                                                                                                                                                                                                                                                                                                                                                                                                                                       >
         Estimates: {rows: ? (?), cpu: ?, memory: 0B, network: 0B}                                                                                                                                                                                                                                                                                                                                                                                                                          >
         r_reason_sk := r_reason_sk:bigint:int8
